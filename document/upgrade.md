### 移动端进阶手册
#### 第一阶段 命令式编程
- 知识点:Dart语言采用命令式范式与Flutter基础Widget构建功能模块.

#### 第二阶段 MVVM完成代码分层
- 初级解耦,增加代码可读性,维护性,精细化状态管理提升性能.

-  知识点:实现状态层(数据),逻辑层,视图层的分层,使用provider进行状态管理(逻辑层对状态层的修改,通知界面刷新).
- 痛点:代码复用性差,代码冗余过多.

#### 第三阶段 面向对象
- 采用面向对象编程范式,将各模块拆分复用解决冗余,提升开发效率,便于后期维护等,众多优点.
- 知识点:继承,混入,泛型,多态,组合/聚合关系,单一职责原则,开闭原则,里氏替换等.
- 问题:模块间耦合严重.
- 代码结构
  - Model层:将每个接口的JSON结构转换为对应的Model.
  - ViewModel层:拆分请求类,筛选,列表数据,刷新加载,搜索,详情列表,添加编辑,页面状态等逻辑.拆分的模块将以混入方式与ChangeNotifier组合为一种页面形式的父类(组合关系).例如请求类+页面状态+详情+底部组件 = 详情页;请求类 + 页面状态 + 列表数据 + 加载加载 + 筛选 = 筛选列表;拆分应该遵守单一职原则,每个类仅支持一个功能.遵循开闭原则,例如请求类封装后,筛选功能依赖请求类,请求类封装后应该对修改关闭,对扩展开放,所以禁止将筛选功能写入请求类,应该拆分出去,成为请求类的混入类,通过混入进行扩展.里氏替换原则,父类的任何子类都应该可以替换父类,继承关系不能使父类原本的功能受损或替换.
  - View层:将筛选,刷新加载,搜索,页面状态等Widget进行封装,本层知识点:与逻辑层相似的组合关系.依赖注入:封装后的Widget如果依赖传值和回调与view_model层通信依然会产生大量的冗余代码,对Widget精细化的状态管理也需要包裹Build,增加冗余.于是将view_model传入Widget内部进行通信将节省大量代码,通过泛型约束传入(多态特性).这种依赖关系为聚合关系,实现方式为依赖注入.依赖provider设计的依赖注入:因为provider特殊的泛型取值方式,View层仅需要设置泛型即可,整个Page页面没有任何传值操作,依赖注入也将以泛型来实现.

### 第四阶段 面向接口

- 面向接口编程,充分解耦,模块间灵活的依赖关系.

- 知识点:将依赖关系抽象化实现解耦.接口隔离原则,最小知道原则,依赖倒置原则.

  项目中面向接口解耦的问题:
  第三层的封装造就了重要的请求类,大多数功能直接引用请求类,形成极强的耦合关系,请求类如果被删除或替换,整个工程都要修改,于是对请求类进行抽象化封装,将请求类原有的功能拆分为请求状态,页面数据,数据数量,发起请求这四个接口,拆分接口应该遵循接口原则每个接口都只做一件事情.
  经过抽象化以后,子功能不再依赖请求类,而是依赖对应的接口,如页面状态,依赖请求状态接口,列表数据依赖页面数据接口,筛选和搜索依赖发起请求接口等,拆分后代码遵循了依赖倒置原则,细节(具体的实现)依赖与抽象,同时子功能不在引用请求类,仅依赖一个接口则实现的最小知道原则.